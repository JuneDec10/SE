埃拉托斯特尼筛法

埃拉托斯特尼筛法（， ），简称-{zh-cn:埃氏筛; zh-tw:埃氏筛; zh-hk:爱氏筛}-，也称素数筛。这是一种简单且历史悠久的筛法，用来找出一定范围内所有的质数。

所使用的原理是从2开始，将每个质数的各个倍数，标记成合数。一个质数的各个倍数，是一个差为此质数本身的等差数列。此为这个筛法和试除法不同的关键之处，后者是以质数来测试每个待测数能否被整除。

埃拉托斯特尼筛法是列出所有小质数最有效的方法之一，其名字来自于古希腊数学家埃拉托斯特尼，并且被描述在另一位古希腊数学家尼科马库斯所著的《算术入门》中。

给出要筛数值的范围n，找出以内的-{zh-cn:素数;zh-tw:质数;}-formula_1。先用2去筛，即把2留下，把2的倍数剔除掉；再用下一个质数，也就是3筛，把3留下，把3的倍数剔除掉；接下去用下一个质数5筛，把5留下，把5的倍数剔除掉；不断重复下去...。

详细列出算法如下：



结论：去掉红色的数字，2到25之间的质数是：2, 3, 5, 7, 11, 13, 17, 19, 23。

埃拉托斯特尼筛法，可以用以下的-{zh-cn:伪代码;zh-tw:虚拟码;}-来表示：

以上演算法可以得到小于等于的所有-{zh-cn:素数;zh-tw:质数;}-，它的复杂度是。

bool flag[MAXN] = {1}; //将标识初始化为true
void erat(int maxn)

