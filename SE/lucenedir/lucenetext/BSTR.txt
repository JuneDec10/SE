BSTR

BSTR（Basic String）是一种Pascal-Style字符串（明确标示字符串长度）和C-Style字符串（以\0结尾）的混合物，一般用于COM中，是Unicode字符串，即标示字符串长度，最后还有一个值为\0字节。

对于BSTR，NULL与""有相同的语义（Visual Basic引入的语义）。BSTR的长度不包含结尾的\0字节。BSTR必须用SysAlloc*操作系统API申请与释放。
C程序语言本身原并不支援字串资料结构。字符串通常以一个字符数组（或称阵列）或一个指向字符资料的指标来表达。由于C语言的数组不包含其长度的资讯，故亦无法表示所载之字符串之长度。C语言社群对此通用之解决方案为于字符串末端增添一数值0的字符。C语言的标准程序库中的字符串处理功能亦以此为基础。C-Style 字符串特点为不直接包含长度资讯。要取得字符串之长度，就必须从头到尾数算字符数目，直到遇到字符0为止。由于不设长度资讯，故C-style 字符串的长度理论上可以无上限。
Pascal程序语言采取另一种方向处理字符串。在储存字串的记忆空间的开首，储存一固定长度整数以表达其长度。如此Pascal-style 字符串不需要在最后增添额外字符以标明其结束。但由于字符串开首储存字串长度的空间有限，故Pascal-style 的字串长度有上限。但在获得字串长度方面有速度优势。

BSTR 字符串结合了C-style 字符串和Pascal-style字符串。它在前4字节储存了字符串长度（字符串的字节数，但不包括Null结束符），在字符串结尾以字符0识别。和pascal-style 字符串不同，指向BSTR字符串的指标指向第一个字符，而非开首的字串长度。故此适用于读取C-style 字符串的程序库同样适用于BSTR字符串（但写入则另作别论）。 字符是按照Unicode编码保存。允许在BSTR串中间嵌入NULL字符。

Windows提供了BSTR相关函数： 

