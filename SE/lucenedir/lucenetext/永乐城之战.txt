永乐城之战

宋夏自从庆历和议以后，双方维持了将近半个世纪的和平。到了宋神宗时期，西夏外戚梁太后与其弟梁乙埋姐弟当权，国势衰落，政治腐败，西夏举国上下怨声载道，民不聊生。梁太后多次出兵攻宋，想提高国内政治威望，却都惨败而归。宋神宗认为西夏无理，下令攻灭西夏。宋军于元丰四年（1081年）11月在庆州（今甘肃庆阳）击溃夏军，占领西夏两千多里土地。神宗大喜，命给事中徐禧、鄜延道总管种谔于元丰五年（1082年）9月带兵攻夏，准备一举灭夏。

徐禧等人率领二万五千禁军，景思宜有四千禁军，另有厢军四万人，总兵力约七万人，攻入西夏横山地区，直逼西夏首都兴庆府（今宁夏银川）。为了消灭西夏，徐禧等人在永乐川筑永乐城（今宁夏境内），种谔认为永乐距银州故城不远，三面绝崖而无水泉，力谏说在永乐筑城必然失败。徐禧怒斥种谔，并上奏朝廷，弹劾种谔骄横。又把种谔调往延州，种谔由是怨怼。至九月初六，筑成，徐禧令景思宜领四千人镇守，自行带中军，右虞侯军，右军八千余人返米脂。

不出十日，西夏梁氏遣统军叶悖麻、咩讹埋等，领六监军司兵三十万攻永乐城，曲珍忙报知徐禧。徐禧与李舜举、李稷等，统兵往援，令沈括留守米脂。部下高永亨建议夏军渡永定河时突袭敌军，徐禧以为“王师不鼓不成列。”予以拒绝，而以兵万人列阵城下。夏军渡永定河后，向宋军发动猛攻，宋军战败，退入城中。夏军兵围永乐城，截断流经城中的水源，永乐城中缺水，“掘井不及泉”，“士卒渴死者太半”。沈括以及宦官李宪等人的救兵受阻。鄜延道总管种谔因为怨恨徐禧，竟未予以援救。高永能劝徐禧尽出金帛招募敢死队血拼，徐禧不听。鄜延路副总管曲珍劝徐禧突围，徐禧亦不听。

二十日夜，天降大雨，新建城墙浸水后被夏军擂垮，宋军饥疲不能拒，夏军终攻破永乐城，徐禧、李舜举、李稷、高永能等人死难，《宋诗纪事本末》，卷四十，《西夏用兵》言宋军二十多万士卒役夫阵亡，只有曲珍、王湛、李浦、吕整裸跣逃脱，《邵氏闻见录》称“灵武之役，丧师覆将，涂炭百万，帝中夜得报，起环榻行，彻旦不寐。”次日神宗对辅臣痛哭失声，史称永乐城之战。根据台湾学者方震华之分析，宋军在此役之中的损失约在二万到三万战斗部队以及留在城内的厢军和保甲等，二十万为后人政治目的而夸大。
永乐城之战后，宋神宗开始悔悟，而不再轻言开战。


